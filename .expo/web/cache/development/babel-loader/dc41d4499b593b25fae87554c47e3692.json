{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useEffect, useCallback, useState, useLayoutEffect } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport { UserImgWrapper, UserImg } from \"./Styles/MessageStyles\";\nimport { Avatar } from 'react-native-elements';\nimport { auth, db } from \"../firebase\";\nimport { signOut } from 'firebase/auth';\nimport { GiftedChat } from 'react-native-gifted-chat';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport Icon from \"@expo/vector-icons/FontAwesome5\";\nimport Ionicons from \"@expo/vector-icons/Ionicons\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\n\nvar Chat = function Chat(_ref) {\n  var route = _ref.route,\n      navigation = _ref.navigation;\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      messages = _useState2[0],\n      setMessages = _useState2[1];\n\n  var arr = [];\n  var STORAGE_KEY = \"CHAT_DATA\";\n  var _route$params = route.params,\n      receipentName = _route$params.receipentName,\n      receipentProfileImage = _route$params.receipentProfileImage,\n      currentuserId = _route$params.currentuserId;\n  var currentUserData = route.params.currentUserData;\n  useLayoutEffect(function () {\n    navigation.setOptions({\n      title: receipentName,\n      headerLeft: function headerLeft() {\n        return _jsx(View, {\n          style: {\n            marginLeft: 20\n          },\n          children: _jsx(UserImgWrapper, {\n            children: _jsx(UserImg, {\n              source: {\n                uri: \"https://firebasestorage.googleapis.com/v0/b/convers-5a5ea.appspot.com/o/images%2FCkMIUQ2zQ2Q3xasb2qjSY36bUfP2?alt=media&token=832fdb47-b188-476a-817f-b30dbf5272bc\"\n              }\n            })\n          })\n        });\n      }\n    });\n  }, [navigation]);\n  useEffect(function () {\n    console.log(receipentName);\n    setMessages([{\n      _id: 1,\n      text: 'Hello developer',\n      createdAt: new Date(),\n      user: {\n        _id: 2,\n        name: 'React Native',\n        avatar: 'https://placeimg.com/140/140/any'\n      }\n    }]);\n  }, []);\n\n  var _onSend = useCallback(function () {\n    var messages = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n    setMessages(function (previousMessages) {\n      return GiftedChat.append(previousMessages, messages);\n    });\n    arr.push(messages);\n\n    for (var i = 0; i < arr.length; i++) {\n      console.log(JSON.stringify(arr[i])._id);\n      console.log(JSON.stringify(arr[i], null, 4));\n    }\n\n    var saveData = function _callee() {\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return _regeneratorRuntime.awrap(AsyncStorage.setItem(STORAGE_KEY, JSON.stringify(arr)));\n\n            case 3:\n              alert('Data successfully saved');\n              _context.next = 9;\n              break;\n\n            case 6:\n              _context.prev = 6;\n              _context.t0 = _context[\"catch\"](0);\n              alert('Failed to save the data to the storage');\n\n            case 9:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, [[0, 6]], Promise);\n    };\n\n    saveData();\n\n    var getData = function _callee2() {\n      var jsonValue;\n      return _regeneratorRuntime.async(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              _context2.next = 3;\n              return _regeneratorRuntime.awrap(AsyncStorage.getItem(STORAGE_KEY));\n\n            case 3:\n              jsonValue = _context2.sent;\n              return _context2.abrupt(\"return\", jsonValue != null ? console.log(\" retrieved value:\" + JSON.parse(jsonValue)[1].user) : null);\n\n            case 7:\n              _context2.prev = 7;\n              _context2.t0 = _context2[\"catch\"](0);\n\n            case 9:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, null, null, [[0, 7]], Promise);\n    };\n\n    getData();\n  }, []);\n\n  console.log(messages);\n  return _jsx(GiftedChat, {\n    textInputStyle: styles.composer,\n    minComposerHeight: 40,\n    minInputToolbarHeight: 60,\n    messages: messages,\n    messagesContainerStyle: {},\n    showAvatarForEveryMessage: true,\n    onSend: function onSend(messages) {\n      return _onSend(messages);\n    },\n    user: {\n      _id: currentuserId,\n      name: currentUserData.name,\n      avatar: currentUserData.profileImageUrl\n    }\n  });\n};\n\nvar styles = StyleSheet.create({\n  composer: {\n    borderRadius: 25,\n    borderWidth: 0.5,\n    borderColor: '#dddddd',\n    marginTop: 10,\n    marginBottom: 10,\n    paddingLeft: 10,\n    paddingTop: 5,\n    paddingBottom: 5,\n    paddingRight: 10,\n    fontSize: 16\n  },\n  btnSend: {\n    height: 40,\n    width: 40,\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginRight: 10,\n    borderRadius: 50\n  }\n});\nexport default Chat;","map":{"version":3,"names":["React","useEffect","useCallback","useState","useLayoutEffect","UserImgWrapper","UserImg","Avatar","auth","db","signOut","GiftedChat","AsyncStorage","Icon","Ionicons","Chat","route","navigation","messages","setMessages","arr","STORAGE_KEY","params","receipentName","receipentProfileImage","currentuserId","currentUserData","setOptions","title","headerLeft","marginLeft","uri","console","log","_id","text","createdAt","Date","user","name","avatar","onSend","previousMessages","append","push","i","length","JSON","stringify","saveData","setItem","alert","getData","getItem","jsonValue","parse","styles","composer","profileImageUrl","StyleSheet","create","borderRadius","borderWidth","borderColor","marginTop","marginBottom","paddingLeft","paddingTop","paddingBottom","paddingRight","fontSize","btnSend","height","width","alignItems","justifyContent","marginRight"],"sources":["/Users/stavan/Documents/End_Sem_Project/screens/Chat.js"],"sourcesContent":["import React, { useEffect, useCallback, useState, useLayoutEffect } from 'react';\nimport { View, Text, StyleSheet, TouchableOpacity } from 'react-native';\nimport {\n    UserImgWrapper,UserImg\n} from './Styles/MessageStyles';\nimport { Avatar } from 'react-native-elements';\nimport { auth, db } from '../firebase';\nimport { signOut } from 'firebase/auth';\nimport { GiftedChat } from 'react-native-gifted-chat';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport Icon from 'react-native-vector-icons/FontAwesome5';\nimport Ionicons from 'react-native-vector-icons/Ionicons';\n\n\nconst Chat = ({ route,navigation }) => {\n    const [messages, setMessages] = useState([]);\n    const arr = [];\n    let STORAGE_KEY = \"CHAT_DATA\";\n    const {receipentName,receipentProfileImage,currentuserId} = route.params;\n    const currentUserData = route.params.currentUserData;\n\n\n\n    useLayoutEffect(() => {\n        navigation.setOptions({\n            title: receipentName,\n            headerLeft: () => (\n                <View style={{ marginLeft: 20 }}>\n                    <UserImgWrapper>\n                    <UserImg source={{\n                        uri: \"https://firebasestorage.googleapis.com/v0/b/convers-5a5ea.appspot.com/o/images%2FCkMIUQ2zQ2Q3xasb2qjSY36bUfP2?alt=media&token=832fdb47-b188-476a-817f-b30dbf5272bc\",\n                    }} />\n                    </UserImgWrapper>\n                </View>\n            )\n        })\n    }, [navigation]);\n\n    useEffect(() => {\n        console.log(receipentName);\n        setMessages([\n            {\n                _id: 1,\n                text: 'Hello developer',\n                createdAt: new Date(),\n                user: {\n                    _id: 2,\n                    name: 'React Native',\n                    avatar: 'https://placeimg.com/140/140/any',\n                },\n            },\n        ])\n    }, []);\n    const onSend = useCallback((messages = []) => {\n        setMessages(previousMessages => GiftedChat.append(previousMessages, messages))\n        arr.push(messages);\n        for(let i=0; i<arr.length; i++)\n        {\n            // console.log(\"element\" + i + \"=\" + arr[i].Text);\n            console.log(JSON.stringify(arr[i])._id);\n            console.log(JSON.stringify(arr[i], null, 4));\n        }\n\n        const saveData = async () => {\n            try {\n              await AsyncStorage.setItem(STORAGE_KEY, JSON.stringify(arr))\n              alert('Data successfully saved')\n            } catch (e) {\n              alert('Failed to save the data to the storage')\n            }\n          }\n\n          saveData();\n\n          const getData = async () => {\n            try {\n              const jsonValue = await AsyncStorage.getItem(STORAGE_KEY)\n              return jsonValue != null ? console.log(\" retrieved value:\" + JSON.parse(jsonValue)[1].user) : null;\n            } catch(e) {\n              // error reading value\n            }\n          }\n\n          getData();\n        \n    }, []);\n    console.log(messages);\n    \n    return (\n        <GiftedChat\n            textInputStyle={styles.composer}\n            minComposerHeight={40}\n            minInputToolbarHeight={60}\n            messages={messages}\n            messagesContainerStyle={{\n                \n            }}\n            // parsePatterns={(linkStyle) => [\n            //     { type: 'phone', style: linkStyle, onPress: this.onPressPhoneNumber },\n            //     { pattern: /#(\\w+)/, style: { ...linkStyle, styles.hashtag }, onPress: this.onPressHashtag }\n            // ]}\n            showAvatarForEveryMessage={true}\n            // enderSend={(props) => (\n            //     <View style={{ flexDirection: 'row', alignItems: 'center', height: 60 }}>\n            //       {/* <BtnRound icon=\"camera\" iconColor={Colors.red} size={40} style={{ marginHorizontal: 5 }} onPress={() => this.choosePicture()} /> */}\n            //       <Send>\n            //         <View style={styles.btnSend}>\n            //           <Ionicons name=\"ios-send\" size={24} color=\"red\" />\n            //         </View>\n            //       </Send>\n            //     </View>\n            //   )}\n            onSend={messages => onSend(messages)}\n            user={{\n                _id: currentuserId,\n                name: currentUserData.name,\n                avatar: currentUserData.profileImageUrl\n            }}\n        />\n    );\n}\n\n\n const styles = StyleSheet.create({\n    composer:{\n        borderRadius: 25, \n        borderWidth: 0.5,\n        borderColor: '#dddddd',\n        marginTop: 10,\n        marginBottom: 10,\n        paddingLeft: 10,\n        paddingTop: 5,\n        paddingBottom: 5,\n        paddingRight: 10,\n        fontSize: 16\n      },\n      btnSend: {\n        height: 40,\n        width: 40,\n        alignItems: 'center',\n        justifyContent: 'center',\n        marginRight: 10,\n        borderRadius: 50\n      }\n });\n\nexport default Chat;\n\n\n\n\n\n\n\n\n\n\n\n// import React, { useEffect, useCallback, useState, useLayoutEffect } from 'react';\n// import { View, Text, StyleSheet, TouchableOpacity } from 'react-native';\n// import { GiftedChat } from 'react-native-gifted-chat';\n \n// const Chat = ({ navigation }) => {\n//    const [messages, setMessages] = useState([]);\n\n//    useLayoutEffect(() => {\n//        navigation.setOptions({\n//            headerLeft: () => (\n//                <View style={{ marginLeft: 20 }}>\n//                </View>\n//            ),\n//            headerRight: () => (\n//                <TouchableOpacity style={{\n//                    marginRight: 10\n//                }}\n//                >\n//                    <Text>logout</Text>\n//                </TouchableOpacity>\n//            )\n//        })\n//    }, [navigation]);\n \n//    useEffect(() => {\n//        setMessages([\n//            {\n//                _id: 1,\n//                text: 'Hello developer',\n//                createdAt: new Date(),\n//                user: {\n//                    _id: 2,\n//                    name: 'React Native',\n//                    avatar: 'https://placeimg.com/140/140/any',\n//                },\n//            },\n//        ])\n//    }, []);\n//    const onSend = useCallback((messages = []) => {\n//        setMessages(previousMessages => GiftedChat.append(previousMessages, messages))\n//    }, []);\n//    return (\n//        <GiftedChat\n//            messages={messages}\n//            showAvatarForEveryMessage={true}\n//            onSend={messages => onSend(messages)}\n//            user={{\n//                _id: 1,\n//                name: \"Stavan\",\n//                avatar: \"https://placeimg.com/140/140/any\",\n//            }}\n//        />\n//    );\n// }\n \n// export default Chat;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}